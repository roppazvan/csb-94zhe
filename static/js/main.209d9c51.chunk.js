(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{31:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var r,c=n(0),s=n(14),a=n.n(s),o=n(4),i=n(7),u=n(6),l=n(10),j=n.n(l),b=n(16),p=Object(i.b)("users/login",function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,c=t.password,e.prev=1,e.next=4,fetch("https://mock-user-auth-server.herokuapp.com/api/v1/auth",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:r,password:c})});case 4:return s=e.sent,e.next=7,s.json();case 7:if(a=e.sent,200!==s.status){e.next=13;break}return localStorage.setItem("token",a.token),e.abrupt("return",a);case 13:return e.abrupt("return",n.rejectWithValue(a));case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.log("Error",e.t0.response.data),n.rejectWithValue(e.t0.response.data);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,n){return e.apply(this,arguments)}}()),h=Object(i.b)("users/signupUser",function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c,s,a,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,c=t.email,s=t.password,e.prev=1,e.next=4,fetch("https://mock-user-auth-server.herokuapp.com/api/v1/users",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:r,email:c,password:s})});case 4:return a=e.sent,e.next=7,a.json();case 7:if(o=e.sent,200!==a.status){e.next=13;break}return localStorage.setItem("token",o.token),e.abrupt("return",{username:r,email:c});case 13:return console.log("Error",o),e.abrupt("return",n.rejectWithValue(o));case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(1),console.log("Error",e.t0.response.data),e.abrupt("return",n.rejectWithValue(e.t0.response.data));case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t,n){return e.apply(this,arguments)}}()),d=Object(i.b)("users/getLoggedUserInformation",function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("get Logged user info",t),r={status:200},"Razvanel",c="Email user logat cu ".concat(t),200!==r.status){e.next=9;break}return e.abrupt("return",{username:"Razvanel",email:c});case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}()),O={username:"",email:"",isFetching:!1,isSuccess:!1,isError:!1,errorMessage:""},g=Object(i.c)({name:"user",initialState:O,reducers:{clearErrors:function(e){return e.isError=!1,e.errorMessage="",e},logoutSuccess:function(){return console.log("Logout Success"),O}},extraReducers:(r={},Object(u.a)(r,p.fulfilled,(function(e,t){var n=t.payload;return e.email=n.email,e.username=n.name,e.isFetching=!1,e.isSuccess=!0,e})),Object(u.a)(r,p.rejected,(function(e,t){var n=t.payload;console.log("payload",n),e.isFetching=!1,e.isError=!0,e.errorMessage=n.message})),Object(u.a)(r,p.pending,(function(e){e.isFetching=!0})),Object(u.a)(r,h.fulfilled,(function(e,t){var n=t.payload;return e.email=n.email,e.username=n.username,e.isFetching=!1,e.isSuccess=!0,e})),Object(u.a)(r,h.rejected,(function(e,t){var n=t.payload;console.log("REJECTED"),e.isFetching=!1,e.isError=!0,e.errorMessage=n.message})),Object(u.a)(r,h.pending,(function(e){console.log("PENDING"),e.isFetching=!0})),Object(u.a)(r,d.fulfilled,(function(e,t){var n=t.payload;return e.email=n.email,e.username=n.username,e})),r)}),f=g.actions,m=f.clearErrors,x=f.logoutSuccess,v=function(e){return e.user},k=Object(i.a)({reducer:{user:g.reducer}}),y=(n(31),n(9)),S=n(2),E=n(1),w=function(){var e=Object(o.b)(),t=Object(o.c)(v),n=t.isFetching,r=t.errorMessage,s=t.isError,a=t.isSuccess,i=Object(S.g)(),u=Object(c.useState)(""),l=Object(y.a)(u,2),j=l[0],b=l[1],h=Object(c.useState)(""),d=Object(y.a)(h,2),O=d[0],g=d[1];return Object(c.useEffect)((function(){a&&i.push("/")}),[a,i]),Object(c.useEffect)((function(){return function(){e(m())}}),[e]),n?Object(E.jsx)("h1",{children:"Fetching user"}):Object(E.jsxs)("div",{children:[Object(E.jsx)("h1",{children:"Login page"}),s&&r?Object(E.jsx)("div",{style:{color:"red"},children:r}):null,Object(E.jsx)("input",{type:"email",onChange:function(e){b(e.target.value)}}),Object(E.jsx)("input",{type:"password",onChange:function(e){g(e.target.value)}}),Object(E.jsx)("button",{onClick:function(){e(p({email:j,password:O}))},children:"Login now"}),Object(E.jsxs)("div",{children:[Object(E.jsx)("span",{children:"Dont have an account ?"}),Object(E.jsx)("button",{onClick:function(){i.push("/register")},children:"Register here"})]})]})},C=function(){var e=Object(o.b)(),t=Object(S.g)(),n=Object(c.useState)(""),r=Object(y.a)(n,2),s=r[0],a=r[1],i=Object(c.useState)(""),u=Object(y.a)(i,2),l=u[0],j=u[1],b=Object(c.useState)(""),p=Object(y.a)(b,2),d=p[0],O=p[1],g=Object(o.c)(v),f=g.isFetching,m=g.errorMessage,x=g.isError,k=g.isSuccess;return console.log(g),Object(c.useEffect)((function(){k&&t.push("/")}),[k,t]),f?Object(E.jsx)("h1",{children:"Creating account"}):Object(E.jsxs)("div",{children:[Object(E.jsx)("h1",{children:"Create an account"}),Object(E.jsxs)("div",{children:[x?Object(E.jsx)("div",{style:{color:"red"},children:m}):null,Object(E.jsx)("input",{name:"name",type:"text",onChange:function(e){O(e.target.value)}}),Object(E.jsx)("label",{htmlFor:"name",children:"Name"})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("input",{name:"email",type:"email",onChange:function(e){a(e.target.value)}}),Object(E.jsx)("label",{htmlFor:"email",children:"Email"})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("input",{type:"password",onChange:function(e){j(e.target.value)}}),Object(E.jsx)("label",{htmlFor:"password",children:"Password"})]}),Object(E.jsx)("button",{onClick:function(){e(h({name:d,email:s,password:l}))},children:"Register now"}),Object(E.jsxs)("div",{children:[Object(E.jsx)("span",{children:"Already have an account ?"}),Object(E.jsx)("button",{onClick:function(){t.push("/login")},children:"Login here"})]})]})},F=function(){return!!localStorage.getItem("token")},I=function(){var e=Object(o.b)(),t=Object(o.c)(v),n=t.email,r=t.username,s=Object(S.g)();Object(c.useEffect)((function(){F()||s.push("/login")})),Object(c.useEffect)((function(){if(!n){console.log("should get user info");var t=localStorage.getItem("token");e(d(t))}}),[e,n]);return Object(E.jsxs)("div",{children:[Object(E.jsxs)("h1",{children:["Dashboard for ",n," ",r," "]}),Object(E.jsx)("button",{onClick:function(){localStorage.removeItem("token"),e(x()),s.push("/login")},children:"Log out"})]})},L=n(13),M=n(22),R=["component"],J=function(e){var t=e.component,n=Object(M.a)(e,R);return F()?Object(E.jsx)(S.b,Object(L.a)(Object(L.a)({},n),{},{render:function(e){return Object(E.jsx)(t,Object(L.a)(Object(L.a)({},e),n))}})):Object(E.jsx)(S.a,{to:"/login"})};function N(){return Object(E.jsxs)(S.d,{children:[Object(E.jsx)(J,{exact:!0,path:"/",component:I}),Object(E.jsx)(S.b,{path:"/login",component:w}),Object(E.jsx)(S.b,{path:"/register",component:C})]})}var T=n(8),D=document.getElementById("root");a.a.render(Object(E.jsx)(o.a,{store:k,children:Object(E.jsx)(c.StrictMode,{children:Object(E.jsx)(T.a,{children:Object(E.jsx)(N,{})})})}),D)}},[[35,1,2]]]);
//# sourceMappingURL=main.209d9c51.chunk.js.map